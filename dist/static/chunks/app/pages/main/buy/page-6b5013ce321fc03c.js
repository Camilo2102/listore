(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[187],{55705:function(e,t,i){Promise.resolve().then(i.bind(i,9601))},52845:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});var n=i(9268);function r(e){let{title:t}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"col-12 flex justify-content-center",children:(0,n.jsx)("h2",{style:{fontSize:"50px",color:"#9e6a90",fontStyle:"italic",marginTop:"1px"},children:t})})})}},46157:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});let n={rows:10,first:0,page:0,totalRecords:0,pagesVisited:0,loaded:!1}},59808:function(e,t,i){"use strict";i.d(t,{A:function(){return n}});class n{}n.INVENTORY="inventory",n.PRODUCT="product",n.USER="user",n.SUPPLIER="supplier",n.SPENT="spent",n.ATTRIBUTES="atributes",n.SALE="sale",n.BUY="buy",n.PATTERN="pattern",n.KINDOFPRODUCT="kindOfProduct",n.CHARACTERISTIC="characteristic"},35864:function(e,t,i){"use strict";i.d(t,{y:function(){return r}});var n=i(9268);function r(){return{formatDate:e=>{let[t,i,n,r=0,a=0,l=0]=e,d=n.toString().padStart(2,"0"),o=i.toString().padStart(2,"0"),c="".concat(d,"/").concat(o,"/").concat(t),u="".concat(r.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"));return 0===r&&0===a&&0===l?c:"".concat(c," - ").concat(u)},formatCurrency:e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),formatDetail:e=>(0,n.jsx)("ul",{style:{padding:"0",listStyle:"inside"},children:Object.keys(e).map(t=>(0,n.jsxs)("li",{children:[t,": ",e[t]]},"prop-name-"+t))})}}},93030:function(e,t,i){"use strict";i.d(t,{$h:function(){return d},GW:function(){return o}});var n=i(9268),r=i(73855),a=i(86006);let l=(0,a.createContext)({});function d(){return(0,a.useContext)(l)}function o(e){let{children:t}=e,[i,a]=(0,r.W)("product");return(0,n.jsx)(l.Provider,{value:{product:i,setProduct:a},children:t})}},19458:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});var n=i(86006);function r(e,t){let i=(0,n.useRef)(!1);(0,n.useEffect)(()=>{i.current?e():i.current=!0},t)}},14574:function(e,t,i){"use strict";i.d(t,{N:function(){return r}});var n=i(86006);let r=(0,n.createContext)({})},9601:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return O}});var n=i(9268),r=i(86006),a=i(93030),l=i(3702),d=i(70686),o=i(35105),c=i(14574),u=i(52899),s=i(67121),f=i(85188),p=i(78980),m=i(11993),v=i(39451),h=i(87823),y=i(59808),P=i(97340),S=i(61804),x=i(91148),b=i(46157),C=i(35864);function E(e){let{visible:t,setVisible:i}=e,{createAll:a}=(0,h.Z)(y.A.BUY),{getCredentials:o}=(0,P.Z)(),[E,g]=(0,r.useState)([]),{showSuccess:N}=(0,x.V)(),j=(0,h.Z)(y.A.PATTERN),O=(0,h.Z)(y.A.ATTRIBUTES),[k,T]=(0,r.useState)(!1),{isValidRes:I}=(0,S.Z)(),{requiered:R,maxLenght:A,minLenght:D}=(0,p.Z)(),[U,Z]=(0,r.useState)([{field:"inventory",value:"",description:"Inventario",colSize:6,type:u.h.INPUTHELPER,validators:[R,A(200),D(3)],invalid:!1,message:!0,columns:[{field:"name",header:"Nombre"},{field:"description",header:"Descripcion"},{field:"category",header:"Categoria"}],icon:"pi-user",service:y.A.INVENTORY,filter:{values:[{field:"category",label:"Categor\xeda",value:""},{field:"description",label:"Descripci\xf3n",value:""},{field:"name",label:"Nombre",value:""}],required:{company:{id:o().company}}},fieldDependency:[{field:"product",value:"id",toInput:!0,enable:!0},{field:"kindOfProduct",value:"id",toInput:!1,enable:!1}]},{field:"product",value:"",description:"Producto",colSize:6,type:u.h.INPUTHELPER,validators:[R,A(200),D(3)],invalid:!1,message:!0,columns:[{field:"name",header:"Nombre"},{field:"description",header:"Descripcion"}],icon:"pi-user",service:y.A.PRODUCT,disabled:!0,fieldDependency:[{field:"kindOfProduct",value:"id",toInput:!0,enable:!0},{field:"price",value:"unitaryValue",toInput:!1,enable:!0}],filter:{required:{supplier:{}},values:[]}},{field:"kindOfProduct",value:"",description:"Sub-Producto",colSize:6,type:u.h.INPUTHELPER,validators:[R,A(200),D(3)],invalid:!1,message:!0,columns:[{field:"amount",header:"Cantidad"}],icon:"pi-user",service:y.A.KINDOFPRODUCT,disabled:!0,filter:{required:{},values:[]},customMap:e=>(e.characteristics.map(t=>{e[t.name]=t.value}),e.name=e.product.name,e),generateCustomColumns:e=>new Promise(async(t,i)=>{try{let i=await j.getAllByFilter(!0,b.Z,{inventory:{id:e.inventory.id}}),n=await O.getAllByFilter(!0,b.Z,{pattern:{id:i[0].id}}),r=[];r.push({field:"name",header:"Producto"});let a=n.map(e=>({field:e.name,header:e.name}));(r=[...r,...a]).push({field:"amount",header:"Cantidad"}),t(r)}catch(e){i(Error())}})},{field:"price",value:"",description:"Precio",colSize:6,type:u.h.NUMBER,validators:[R,A(200),D(1)],invalid:!1,message:!0,icon:"pi-dollar",disabled:!0},{field:"amount",value:"",description:"Cantidad",colSize:6,type:u.h.NUMBER,validators:[R,A(200),D(1)],invalid:!1,message:!0,icon:"pi-tags"}]),[V,F,w,z]=(0,f.p)(U),{buy:B,setBuy:_}=(0,r.useContext)(c.N),[L,M]=(0,r.useState)(!1);(0,r.useEffect)(()=>{void 0===B||L||w(B)},[L]);let{formatDetail:Y}=(0,C.y)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(m.Z,{title:"Tabla de compras",visible:t,setVisible:i,children:[(0,n.jsx)("div",{className:"col-12 flex justify-content-start",children:(0,n.jsx)(l.z,{label:"Agregar",icon:"pi pi-plus",onClick:()=>T(!0)})}),(0,n.jsx)(d.Z,{useFilter:!1,showRepotGenerator:!1,columns:[{field:"nameInventory",header:"Inventario"},{field:"nameProduct",header:"Producto"},{field:"details",header:"Detalle",format:Y},{field:"amount",header:"Cantidad"},{field:"price",header:"Precio"}],staticValues:E}),(0,n.jsx)("div",{className:"col-12 flex justify-content-start",children:(0,n.jsx)(l.z,{label:"Cargar compras",icon:"pi pi-check",onClick:()=>{let e=E.map(e=>(delete e.inventory,delete e.nameInventory,delete e.nameProduct,delete e.product,delete e.details,e.user={id:o().user},e.kindOfProduct={id:e.kindOfProduct},e));a(!0,e).then(e=>{I(e)&&(N(s.V.MESSAGE_SUCCESS,s.V.MESSAGE_CREATE_SUCCESS),i(!1),M(!1),_(void 0))})}})})]}),(0,n.jsx)(m.Z,{title:"Nueva Compra",visible:k,setVisible:T,children:(0,n.jsx)(v.Z,{form:F,setValue:w,submit:e=>{e.preventDefault();let[t,i]=z();if(Z([...t]),i){let e=V.kindOfProduct.id;delete V.kindOfProduct.amount,delete V.kindOfProduct.characteristics,delete V.kindOfProduct.id,delete V.kindOfProduct.name,delete V.kindOfProduct.product;let t={price:V.price,amount:V.amount,inventory:V.inventory,product:V.product,nameInventory:V.nameinventory,nameProduct:V.nameproduct,details:V.kindOfProduct,kindOfProduct:e};g(e=>[...e,t]),w({price:"",amount:"",inventory:"",product:""}),T(!1)}},value:V,buttonLabel:"Agregar"})})]})}var g=i(290),N=i(52845),j=i(19458);function O(){let{product:e,setProduct:t}=(0,a.$h)(),{user:i,setUser:u}=(0,r.useContext)(o.x),{reloadData:s,setReloadData:f}=(0,g.S)(),{formatDate:p,formatCurrency:m,formatDetail:v}=(0,C.y)(),[h,S]=(0,r.useState)(!1),{getCredentials:x}=(0,P.Z)(),b={values:[{field:"price",label:"Precio",value:0},{field:"amount",label:"Cantidad",value:0},{field:"initialDate",label:"Fecha Inicial",value:null},{field:"finalDate",label:"Fecha Final",value:null}],required:{user:{id:x().user}}},{setBuy:O}=(0,r.useContext)(c.N);return(0,j.Z)(()=>{h||f(!0)},[h]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex justify-content-center align-items-center",style:{minHeight:"100vh",overflowY:"auto"},children:[(0,n.jsxs)("div",{className:"grid",style:{width:"90%"},children:[(0,n.jsx)(N.Z,{title:"Compras"}),(0,n.jsx)("div",{className:"col-12 flex justify-content-start",children:(0,n.jsx)(l.z,{onClick:()=>{S(!0),O(void 0)},label:"Nuevo",icon:"pi pi-plus"})}),(0,n.jsx)("div",{className:"col-12 flex justify-content-center",children:(0,n.jsx)(d.Z,{columns:[{field:"buyDate",header:"Fecha de compra",format:p},{field:"nameProduct",header:"Producto"},{field:"details",header:"Detalle",format:v},{field:"price",header:"Precio",format:m},{field:"amount",header:"Cantidad"},{field:"totalValue",header:"Valor total",format:m}],baseFilter:b,endpoint:y.A.BUY,customMap:e=>{var t,i;let n=null==e?void 0:null===(t=e.kindOfProduct)||void 0===t?void 0:null===(i=t.product)||void 0===i?void 0:i.name,r={};e.kindOfProduct.characteristics.forEach(e=>{r[e.name]=e.value});let a=e.price*e.amount;return{...e,nameProduct:n,totalValue:a,details:r}}})})]}),h&&(0,n.jsx)(E,{visible:h,setVisible:S})]})})}},35105:function(e,t,i){"use strict";i.d(t,{x:function(){return r}});var n=i(86006);let r=(0,n.createContext)({})}},function(e){e.O(0,[87,546,123,313,856,780,831,253,769,744],function(){return e(e.s=55705)}),_N_E=e.O()}]);